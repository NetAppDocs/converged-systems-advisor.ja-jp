---
sidebar: sidebar 
permalink: task_setup_deploy_agent.html 
keywords: setup, deploy, FlexPod, configuration, VMware, ESXi server, FlexPod, converged, infrastructure, data, agent 
summary: VMware ESXi サーバに Converged Systems Advisor エージェントを導入 
---
= エージェントをセットアップして展開します
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
VMware ESXi サーバに Converged Systems Advisor エージェントを導入する必要があります。エージェントは、 FlexPod コンバージドインフラ内の各デバイスに関する構成データを収集し、そのデータを Converged Systems Advisor ポータルに送信します。

.手順
. <<Download and install the agent>>
. <<Set up networking for the agent>>
. <<Install an SSL certificate on the agent>>
. <<Configure the agent to discover your FlexPod infrastructure>>




== エージェントをダウンロードしてインストールします

VMware ESXi サーバに Converged Systems Advisor エージェントを導入する必要があります。

帯域幅の使用量を最小限に抑えるには、 FlexPod 構成と同じデータセンターにある VMware ESXi サーバにエージェントをインストールする必要があります。エージェントは、各 FlexPod コンポーネントとインターネットに接続し、 HTTPS ポート 443 を使用して Converged Systems Advisor ポータルに設定データを送信できるようにする必要があります。

エージェントは、 Open Virtualization Format （ OVF ）テンプレートから VMware vSphere 仮想マシンとして導入されます。このテンプレートは、 1 vCPU と 2 GB の RAM を持つ Debian ベースのものです（複数以上の FlexPod システムに必要な場合があります）。

.手順
. エージェントをダウンロードします。
+
.. にログインします https://csa.netapp.com/["Converged Systems Advisor ポータル"^]。
.. ［ * エージェントのダウンロード * ］ をクリックします。


. VMware ESXi サーバに OVF テンプレートを導入して、エージェントをインストールします。
+
VMware の一部のバージョンでは、 OVF テンプレートの導入時に警告が表示されることがあります。仮想マシンは最新バージョンの vCenter で開発されたものであり、古いバージョンのハードウェアとの互換性があるため、警告が表示される可能性があります。警告を確認してからインストールを続行する前に、設定オプションを確認してください。





== エージェントのネットワークを設定します

エージェントと FlexPod デバイス間、およびエージェントと複数のインターネットエンドポイント間の通信を可能にするには、エージェント仮想マシンでネットワークが正しく設定されていることを確認する必要があります。ネットワークスタックは、システムが初期化されるまで仮想マシン上で無効になります。

.手順
. アウトバウンドインターネット接続で、次のエンドポイントへのアクセスが有効になっていることを確認します。
+
** csa.netapp.com
** docker.com
** Docker .io と入力します


. VMware vSphere Client を使用して、エージェントの仮想マシンコンソールにログインします。
+
デフォルトのユーザ名は「 CSA 」で、デフォルトのパスワードは「 netapp 」です。

+

TIP: セキュリティ上の理由から、 SSHD はデフォルトで無効になっています。

. プロンプトが表示されたら、デフォルトのパスワードを変更し、パスワードをメモします。回復できないためです。
+
パスワードを変更すると、システムがリブートし、エージェントソフトウェアが起動します。

. DHCP がサブネットにない場合は、標準の Debian ツールを使用して静的 IP アドレスと DNS 設定を構成し、エージェントを再起動します。
+
link:task_setting_static_ip.html["詳細な手順については、ここをクリックしてください"]。

+
Debian 仮想マシンのネットワーク構成は、デフォルトで DHCP に設定されています。NetworkManager がインストールされ、コマンド nmtui から起動できるテキストユーザインターフェイスが提供されます（を参照） https://manpages.debian.org/stretch/network-manager/nmtui.1.en.html["のマニュアルページ"^] 詳細については、を参照してください）。

+
ネットワークの詳細については、を参照してください https://wiki.debian.org/NetworkConfiguration["Debian wiki のネットワーク設定ページ"^]。

. セキュリティポリシーで、 FlexPod デバイスと通信するためにエージェントを 1 つのネットワークに配置し、インターネットと通信するために別のネットワークに配置する必要がある場合は、 vCenter で 2 つ目のネットワークインターフェイスを追加し、正しい VLAN と IP アドレスを設定します。
. インターネットアクセスにプロキシサーバが必要な場合は、次のコマンドを実行します。
+
'UDO CSA_SET_PROXY'

+
このコマンドにより、 2 つのプロンプトが生成され、プロキシエントリに必要な形式が表示されます。最初のプロンプトでは HTTP プロキシを指定し、 2 番目のプロンプトでは HTTPS プロキシを指定できます。

+
HTTP プロキシを http://user:password@proxy-server:proxy-port` の形式で入力します

+
インターネットアクセスに HTTP プロキシが不要な場合は、空白のままにします。

. ネットワークが起動したら、システムがアップデートされて起動するまで約 5 分間待ちます。
+
エージェントが動作可能になると、コンソールにブロードキャストメッセージが表示されます。

. エージェントから次の CLI コマンドを実行して、接続を確認します。
+
....
curl -k https://www.netapp.com/us/index.aspx
....
+
コマンドが失敗した場合は、 DNS 設定を確認します。エージェント仮想マシンには、有効な DNS 設定があり、 csa.netapp.com にアクセスできる必要があります。





== エージェントに SSL 証明書をインストールします

オプション：必要に応じて、 SSL 証明書をエージェントにインストールします。

仮想マシンの初回ブート時に、エージェントが自己署名証明書を作成します。必要に応じて、その証明書を削除して独自の SSL 証明書を使用できます。

Converged Systems Advisor は次の機能をサポートします。 * OpenSSL バージョン 1.0.1 以降と互換性のある暗号 * TLS 1.1 および TLS 1.2

.手順
. エージェントの仮想マシンコンソールにログインします。
. /opt/csa/certs に移動します
. エージェントが作成した自己署名証明書を削除します。
. SSL 証明書を貼り付けます。
. 仮想マシンを再起動します。




== FlexPod インフラストラクチャを検出するようにエージェントを設定します

FlexPod コンバージドインフラの各デバイスから構成データを収集するようにエージェントを設定する必要があります。エージェントは、構成データを収集するためにクレデンシャルを必要としますエージェントの設定時にクレデンシャルを指定する必要があります。

.手順
. Web ブラウザを開き、エージェント仮想マシンの IP アドレスを入力します。
. お客様の NetApp Support Site アカウントのユーザ名とパスワードでエージェントにログインします。
+

NOTE: お客様の代わりにライセンス版の CSA を導入するパートナーは、このステップでお客様のアカウントを使用することが重要です（ネットアップのサポートおよび記録管理のため）。

. エージェントが検出する FlexPod デバイスを追加します。
+
次の 2 つのオプションがあります。

+
.. [ デバイスの追加 ] をクリックして、 FlexPod デバイスの詳細を 1 つずつ入力します。
.. [ デバイスのインポート ] をクリックして、すべてのデバイスの詳細を含む CSV テンプレートを入力し、アップロードします。
+
注： * ユーザー名とパスワードは、以前にデバイス用に作成したアカウントに設定する必要があります。* UCS 環境で LDAP ユーザ管理が設定されている場合は、ユーザ名の前にユーザのドメインを追加する必要があります。たとえば、 local\csa-readonly と指定します





FlexPod インフラストラクチャ内の各デバイスがチェックマーク付きで表に表示されます。image:screenshot_agent_configuration.gif["必要な各デバイスを [ ステータス ] 列に緑色のチェックマークで表示します。"]
